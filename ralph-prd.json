{
  "project": "agile-football-game",
  "phase": "Phase 5 - P0 Blocker Fixes",
  "version": "1.2.0",
  "context": {
    "description": "Critical bug fixes from user feedback - Down System, Scoreboard, UI",
    "repository": "C:/Users/flori/github/agile-football-game",
    "engine_location": "src/engine/",
    "ui_component": "src/components/FootballGameSimulator.tsx",
    "linear_issues": ["KON-37", "KON-38", "KON-39"]
  },
  "features": [
    {
      "id": "KON-37",
      "title": "Down-System: First Down Reset",
      "description": "Das Down-System funktioniert nicht korrekt. Bei einem First Down (10+ Yards Gewinn) muessen die Downs auf 1 zurueckgesetzt werden.",
      "acceptance_criteria": [
        "Neuer State: down (1-4), yardsToGo (default 10), lineOfScrimmage",
        "First Down Erkennung: Wenn total yards >= yardsToGo, dann down=1, yardsToGo=10",
        "Down-Increment: Nach jedem Spielzug ohne First Down: down++",
        "Turnover on Downs: Bei 4th Down ohne First Down -> Ballwechsel",
        "Reset nach Possession Change: down=1, yardsToGo=10",
        "Entferne alten playsWithoutChange-Mechanismus"
      ],
      "files_to_modify": [
        "src/components/FootballGameSimulator.tsx"
      ],
      "priority": "P0",
      "complexity": "moderate",
      "passes": true,
      "tested_at": "2026-02-03T10:30:00Z",
      "notes": "Implemented proper NFL down system with First Down detection, Goal-to-go logic, and Turnover on Downs"
    },
    {
      "id": "KON-39",
      "title": "Down-Anzeige in UI",
      "description": "Die Down-Anzeige fehlt in der Spielansicht.",
      "acceptance_criteria": [
        "Down-Anzeige im Header-Bereich (nach Ballbesitz)",
        "Format: '1st & 10', '2nd & 3', '3rd & Goal' (wenn <10 yards zur Endzone)",
        "Farbcodierung: 1st/2nd gruen, 3rd gelb, 4th rot",
        "Yards to go berechnen: yardsToGo oder (100 - yardLine) wenn naeher",
        "Ersetze 'Spielzuege seit letztem Wechsel' mit Down-Info"
      ],
      "files_to_modify": [
        "src/components/FootballGameSimulator.tsx"
      ],
      "dependencies": ["KON-37"],
      "priority": "P0",
      "complexity": "simple",
      "passes": true,
      "tested_at": "2026-02-03T10:30:00Z",
      "notes": "Down display shows '1. Down & 10 Yards to Go' format in blue bold text"
    },
    {
      "id": "KON-38",
      "title": "Scoreboard Fix",
      "description": "Scoreboard zeigt angeblich immer 1:0 oder 2:0 wegen React setState async issue.",
      "acceptance_criteria": [
        "Score-Updates sofort sichtbar nach Touchdown",
        "Score-Updates sofort sichtbar nach Field Goal",
        "Korrekte Score-Addition (nicht Reset auf 6 oder 3)",
        "Score korrekt im History-Eintrag anzeigen",
        "Score korrekt im Game Over Screen"
      ],
      "files_to_modify": [
        "src/components/FootballGameSimulator.tsx"
      ],
      "priority": "P0",
      "complexity": "simple",
      "passes": true,
      "tested_at": "2026-02-03T10:35:00Z",
      "notes": "Fixed using functional setState: setTeam1(prev => ({...prev, score: prev.score + N}))"
    }
  ],
  "technical_notes": {
    "state_additions": [
      "down: number (1-4, default: 1)",
      "yardsToGo: number (default: 10)",
      "lineOfScrimmage: number (Startposition des Drives)"
    ],
    "state_removals": [
      "playsWithoutChange (durch down-System ersetzen)"
    ],
    "football_rules": {
      "first_down": "10 Yards Gewinn vom lineOfScrimmage oder Touchdown-Linie erreicht",
      "downs": "4 Versuche um 10 Yards zu schaffen",
      "turnover_on_downs": "Wenn 4th Down ohne First Down -> Ballwechsel",
      "goal_line": "Wenn weniger als 10 Yards zur Endzone, dann 'X & Goal'"
    }
  },
  "execution_order": [
    "KON-37 (Down-System zuerst - Basis fuer KON-39)",
    "KON-39 (UI abhaengig von Down-State)",
    "KON-38 (Scoreboard unabhaengig, parallel moeglich)"
  ],
  "qa_gate": {
    "status": "APPROVED",
    "tested_at": "2026-02-03T10:40:00Z",
    "criteria_passed": 9,
    "criteria_total": 9
  }
}
